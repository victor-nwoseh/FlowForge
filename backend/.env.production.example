# =============================================================================
# FlowForge Backend - Production Environment Configuration
# =============================================================================
# Copy this file to .env.production and fill in the values
# NEVER commit .env.production to version control!
# =============================================================================

# -----------------------------------------------------------------------------
# Core Configuration
# -----------------------------------------------------------------------------

# Environment mode (always 'production' for deployed environments)
NODE_ENV=production

# Port for the NestJS backend server
PORT=3001

# -----------------------------------------------------------------------------
# Database - MongoDB
# -----------------------------------------------------------------------------
# Option 1: MongoDB Atlas (Recommended for production)
# Get connection string from: https://cloud.mongodb.com
# Format: mongodb+srv://<username>:<password>@<cluster>.mongodb.net/<database>?retryWrites=true&w=majority
MONGODB_URI=mongodb+srv://your-username:your-password@your-cluster.mongodb.net/flowforge?retryWrites=true&w=majority

# Option 2: Self-hosted MongoDB (Docker Compose)
# MONGODB_URI=mongodb://mongo:27017/flowforge

# -----------------------------------------------------------------------------
# Cache/Queue - Redis
# -----------------------------------------------------------------------------
# Option 1: Redis Cloud (Recommended for production)
# Get connection details from: https://redis.com/cloud/
REDIS_HOST=your-redis-host.redis.cloud
REDIS_PORT=12345
REDIS_PASSWORD=your-redis-password

# Option 2: Redis URL format (some platforms prefer this)
# REDIS_URL=redis://default:your-password@your-host:port

# Option 3: Self-hosted Redis (Docker Compose)
# REDIS_HOST=redis
# REDIS_PORT=6379

# -----------------------------------------------------------------------------
# Authentication - JWT
# -----------------------------------------------------------------------------
# Secret key for signing JWT tokens
# Generate a strong secret: openssl rand -base64 64
JWT_SECRET=your-super-secret-jwt-key-minimum-32-characters-long

# Token expiration time (e.g., 7d, 24h, 60m)
JWT_EXPIRES_IN=7d

# -----------------------------------------------------------------------------
# Security - Encryption
# -----------------------------------------------------------------------------
# 32-character hex key for encrypting OAuth tokens at rest
# Generate with: openssl rand -hex 16
ENCRYPTION_KEY=your32characterencryptionkey12

# -----------------------------------------------------------------------------
# OAuth - Slack Integration
# -----------------------------------------------------------------------------
# Create a Slack App at: https://api.slack.com/apps
# 1. Create New App > From scratch
# 2. OAuth & Permissions > Add redirect URL
# 3. OAuth & Permissions > Add scopes: chat:write, channels:read
# 4. Install to workspace

SLACK_CLIENT_ID=your-slack-client-id
SLACK_CLIENT_SECRET=your-slack-client-secret

# Must match exactly what's configured in Slack App settings
# Format: https://your-backend-domain.com/api/auth/slack/callback
SLACK_REDIRECT_URI=https://your-backend-domain.com/api/auth/slack/callback

# Legacy: Incoming webhook URL (optional, for backward compatibility)
SLACK_WEBHOOK_URL=

# -----------------------------------------------------------------------------
# OAuth - Google Integration
# -----------------------------------------------------------------------------
# Create OAuth credentials at: https://console.cloud.google.com/apis/credentials
# 1. Create Project (or select existing)
# 2. Configure OAuth consent screen
# 3. Create OAuth 2.0 Client ID (Web application)
# 4. Add authorized redirect URI

GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=your-google-client-secret

# Must match exactly what's configured in Google Cloud Console
# Format: https://your-backend-domain.com/api/auth/google/callback
GOOGLE_REDIRECT_URI=https://your-backend-domain.com/api/auth/google/callback

# -----------------------------------------------------------------------------
# Google Sheets - Service Account (Optional)
# -----------------------------------------------------------------------------
# For server-side Google Sheets access without user OAuth
# Create service account at: https://console.cloud.google.com/iam-admin/serviceaccounts
# Share spreadsheets with the service account email

GOOGLE_SHEETS_CLIENT_EMAIL=your-service-account@your-project.iam.gserviceaccount.com
# Note: Replace literal \n with actual newlines or use the escaped format
GOOGLE_SHEETS_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\nYour-Private-Key-Here\n-----END PRIVATE KEY-----\n"

# -----------------------------------------------------------------------------
# Email - SMTP Configuration
# -----------------------------------------------------------------------------
# For Gmail: Enable 2FA and create App Password at https://myaccount.google.com/apppasswords
# For other providers: Use their SMTP settings

SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-password

# -----------------------------------------------------------------------------
# URLs - Application Endpoints
# -----------------------------------------------------------------------------
# Frontend URL (for CORS and OAuth redirects)
FRONTEND_URL=https://your-frontend-domain.com

# Backend URL (for webhook triggers and OAuth callbacks)
# Used to generate webhook URLs in the UI
WEBHOOK_BASE_URL=https://your-backend-domain.com

# -----------------------------------------------------------------------------
# Monitoring - Error Tracking (Optional)
# -----------------------------------------------------------------------------
# Sentry DSN for error tracking
# Get from: https://sentry.io
SENTRY_DSN=

# -----------------------------------------------------------------------------
# Logging (Optional)
# -----------------------------------------------------------------------------
# Log level: error, warn, log, debug, verbose
LOG_LEVEL=log
